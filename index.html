<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Petition Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/0/00/Flag_of_Palestine.svg" type="image/svg+xml">
    <style>
        body {
            background-image: linear-gradient(rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0.7)),
                              url('https://upload.wikimedia.org/wikipedia/commons/0/00/Flag_of_Palestine.svg');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center center;
            background-attachment: fixed;
            background-color: #F5F5F5;
            min-height: 100vh;
        }

        .required::after {
            content: "*";
            color: #ff0000;
            margin-left: 4px;
        }

        .fade {
            transition: opacity 0.5s ease;
        }

        .hidden {
            display: none;
        }

        .chevron-icon {
            transition: transform 0.3s ease;
        }

        .rotate-180 {
            transform: rotate(180deg);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .accordion-content.open {
            max-height: 500px;
        }

        .progress-bar {
            background-color: #E5E7EB;
            border-radius: 9999px;
            overflow: hidden;
            height: 20px;
        }

        .progress-fill {
            background-color: green;
            height: 100%;
            width: 0;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen py-8">
    <div class="max-w-lg w-full bg-white p-10 rounded-lg shadow-lg" x-data="formHandler()" x-init="updateProgress()">
        <h1 class="text-4xl font-bold mb-6 text-center text-red-600">Petition Form</h1>

        <p class="text-sm text-gray-600 mb-4">Fields marked with <span class="text-red-500">*</span> are mandatory</p>

        <!-- Accordions before form -->
        <div class="mb-6 space-y-4">
            <div class="bg-gray-100 rounded-lg">
                <button @click="toggleAccordion('why')" class="w-full text-left py-3 px-4 hover:bg-gray-200 rounded-lg flex justify-between items-center text-lg font-medium">
                    Why fill out this form?
                    <i class="fas fa-chevron-down chevron-icon" :class="{ 'rotate-180': accordions.why }"></i>
                </button>
                <div class="accordion-content" :class="{ 'open': accordions.why }">
                    <div class="px-4 py-2 text-gray-600 italic">
                        By filling out this form, you're supporting the initiative to address the cancellation of student-organized events at Woodlands Secondary School. Your voice matters!
                    </div>
                </div>
            </div>

            <div class="bg-gray-100 rounded-lg">
                <button @click="toggleAccordion('disclaimer')" class="w-full text-left py-3 px-4 hover:bg-gray-200 rounded-lg flex justify-between items-center text-lg font-medium">
                    Disclaimer
                    <i class="fas fa-chevron-down chevron-icon" :class="{ 'rotate-180': accordions.disclaimer }"></i>
                </button>
                <div class="accordion-content" :class="{ 'open': accordions.disclaimer }">
                    <div class="px-4 py-2 text-gray-600">
                        This form is intended for students of Woodlands Secondary School to express their concerns. Please ensure all information provided is accurate.
                    </div>
                </div>
            </div>
        </div>

        <!-- Form Content -->
        <div class="fade" :class="{ 'opacity-0 pointer-events-none': accordions.why || accordions.disclaimer }">
            <!-- Step 1 Form -->
            <form id="form1" x-show="step === 1" @submit.prevent="handleSubmit()" class="space-y-6">
                <div class="input-wrapper">
                    <label for="name" class="block text-xl font-medium text-gray-700 required">Full Name</label>
                    <input type="text" name="name" x-model="name" required
                           class="mt-1 block w-full px-4 py-3 text-xl border border-gray-300 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500"
                           placeholder="Your Full Name">
                </div>

                <div class="input-wrapper">
                    <label for="email" class="block text-xl font-medium text-gray-700 required">Email Address</label>
                    <input type="email" name="email" x-model="email" required
                           class="mt-1 block w-full px-4 py-3 text-xl border border-gray-300 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500"
                           placeholder="you@example.com">
                </div>

                <button type="submit" class="w-full py-3 px-4 text-xl font-semibold text-white bg-red-600 hover:bg-red-700 rounded-md">
                    Send Email 1 <i class="fas fa-paper-plane ml-2"></i>
                </button>
            </form>

            <!-- Step 2 Form -->
            <form id="form2" x-show="step === 2" @submit.prevent="handleSubmit()" class="space-y-6 hidden">
                <h2 class="text-2xl font-bold text-center mb-4">Step 2: Send Email to Student Trustees</h2>

                <button type="submit" class="w-full py-3 px-4 text-xl font-semibold text-white bg-red-600 hover:bg-red-700 rounded-md">
                    Send Email 2 <i class="fas fa-paper-plane ml-2"></i>
                </button>
            </form>

            <!-- Progress Bar -->
            <div class="mt-8">
                <label class="block text-lg font-medium text-gray-700 mb-2" x-text="progressLabel"></label>
                <div class="progress-bar">
                    <div x-ref="progressFill" class="progress-fill"></div>
                </div>
                <p class="text-center mt-2 text-lg font-semibold text-gray-700" x-text="`${currentVotes}/${maxVotes} Emails Sent`"></p>
            </div>

            <!-- Footer -->
            <div class="mt-6 text-center">
                <p class="text-gray-500 text-sm">
                    Made by <a href="https://github.com/AbdullahDaGoat/ShalimarProject" target="_blank" class="text-red-600 hover:underline">Abdullah Khan</a>
                </p>
                <p class="text-gray-500 text-sm">
                    Domain Registered by Sufyan
                </p>
            </div>
        </div>
    </div>

    <script>
        function formHandler() {
            return {
                accordions: {
                    why: false,
                    disclaimer: false
                },
                step: 1,
                name: '',
                email: '',
                currentVotes: 6,
                maxVotes: 100,
                progressLabel: 'Progress to Goal:',

                toggleAccordion(section) {
                    this.accordions[section] = !this.accordions[section];
                },

                updateProgress() {
                    const percentage = Math.min((this.currentVotes / this.maxVotes) * 100, 100);
                    this.$refs.progressFill.style.width = percentage + '%';
                    if (this.currentVotes >= this.maxVotes) {
                        this.progressLabel = 'We reached our Goal, let\'s keep going!';
                    }
                },

                handleSubmit() {
                    if (this.step === 1) {
                        this.sendEmail1();
                    } else if (this.step === 2) {
                        this.sendEmail2();
                    }
                },

                sendEmail1() {
                    const subject = 'Concern Regarding Event Cancellations at Woodlands Secondary School';
                    const body = `Dear School Board Members,\n\nI am a student at Woodlands Secondary School, and I am deeply concerned about the recent cancellation of student-organized events related to important global issues. These events are crucial for supporting student well-being and fostering open dialogue.\n\nI respectfully request that the school board:\n1. Review the reasons behind these cancellations.\n2. Allow students to engage in meaningful discussions.\n\nSincerely,\n${this.name}\nWoodlands Secondary School Student`;

                    const mailtoLink = `mailto:omar.zia@peelsb.com,woodlands.ss@peelsb.com,craig.caslick@peelsb.com,david.green@peelsb.com,jill.promoli@peelsb.com,atheia.grant@peelsb.com,rashmi.swarup@peelsb.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                    window.location.href = mailtoLink;
                    this.fadeToNext();
                },

                sendEmail2() {
                    const subject = 'Support Needed for Student Initiatives at Woodlands Secondary School';
                    const body = `Dear Student Trustees,\n\nAs a fellow student, I am reaching out to seek your support regarding the cancellation of important student-led events at our school. These events are essential for our mental health and understanding of global issues.\n\nI urge you to:\n1. Advocate for the reinstatement of these events.\n2. Ensure student voices are heard at the board level.\n\nThank you for your attention to this matter.\n\nSincerely,\n${this.name}\nWoodlands Secondary School Student`;

                    const mailtoLink = `mailto:pradwit.thapa@peelsb.com,justin.ko@peelsb.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                    window.location.href = mailtoLink;
                    this.currentVotes++;
                    this.updateProgress();
                    alert('Email campaign completed!');
                },

                fadeToNext() {
                    const form1 = document.getElementById('form1');
                    form1.classList.add('fade');
                    form1.classList.add('opacity-0');
                    setTimeout(() => {
                        this.step = 2;
                        form1.classList.add('hidden');
                        const form2 = document.getElementById('form2');
                        form2.classList.remove('hidden');
                        form2.classList.add('fade');
                    }, 500);
                }
            };
        }
    </script>
</body>
</html>
